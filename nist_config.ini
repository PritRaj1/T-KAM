[MIX_PRIOR]
layer_widths = 101, 201
spline_degree = 3
base_activation = gelu
spline_function = B-spline
grid_size = 10
grid_update_ratio = 0.05
grid_range = 0,1 
ε_scale = 0.1
μ_scale = 1
σ_base = 1
σ_spline = 1
init_η = 1
η_trainable = true
π_0 = uniform

[KAN_LIKELIHOOD]
expert_widths = 201, 402
spline_degree = 3
base_activation = gelu
spline_function = B-spline
grid_size = 10
grid_update_ratio = 0.05
grid_range = 0,1 
ε_scale = 0.1
μ_scale = 1
σ_base = 1
σ_spline = 1
init_η = 1
η_trainable = true
generator_noise_var = 0.1
generator_variance = 1
likelihood_model = bernoulli
output_activation = sigmoid

[GRID_UPDATING]
update_prior_grid = false
update_llhood_grid = true
num_grid_updating_samples = 100
grid_update_frequency = 50
grid_update_decay = 0.999

[MALA]
use_langevin = false
step_size = 0.1
noise_var = 0.1
iters = 20

[THERMODYNAMIC_INTEGRATION]
num_temps = 30
p = 1
num_particles = 500
resampler = residual

[TRAINING]
batch_size = 100
MC_expectation_sample_size = 100
N_train = 5000
N_test = 50
num_generated_samples = 200
batch_size_for_gen = 100
N_epochs = 5
use_gpu = true
dataset = MNIST
update_grid = true
verbose = true
contrastive_divergence_training = false
resampling_threshold_factor = 0.5
quantization = FP32

[OPTIMIZER]
type = adam
learning_rate = 0.001
l-bfgs_memory = 100

[LINE_SEARCH]
type = morethuente
c_1 = 1e-4
c_2 = 0.9
rho = 0.5